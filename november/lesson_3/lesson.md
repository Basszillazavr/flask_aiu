
# Урок: Настройка логирования в Flask и управление зависимостями

В этом уроке мы рассмотрим, как настроить логирование в приложении Flask с использованием ротации файлов, а также как управлять зависимостями проекта с помощью файла `requirements.txt`.

## Настройка логирования в Flask

Flask использует встроенный модуль Python `logging` для ведения журналов.
Чтобы настроить логирование с ротацией файлов, выполните следующие шаги:

1. **Импортируйте необходимые модули**:

   ```python
   import logging
   from logging.handlers import RotatingFileHandler
   from flask import Flask
   ```

2. **Создайте экземпляр Flask-приложения**:

   ```python
   app = Flask(__name__)
   ```

3. **Настройте логирование**:

   ```python
   if not app.debug:
       # Создаем обработчик с ротацией файлов
       handler = RotatingFileHandler('app.log', maxBytes=10000, backupCount=3)
       handler.setLevel(logging.INFO)
       formatter = logging.Formatter(
           '[%(asctime)s] %(levelname)s в %(module)s: %(message)s'
       )
       handler.setFormatter(formatter)
       app.logger.addHandler(handler)
   ```

   В этом блоке кода:

   - **RotatingFileHandler**: Создает обработчик, который записывает логи в файл `app.log` и выполняет ротацию при достижении размера в 10 000 байт, сохраняя до трех резервных копий.
   - **Formatter**: Определяет формат лог-сообщений, включая время, уровень, модуль и само сообщение.
   - **app.logger.addHandler(handler)**: Добавляет настроенный обработчик к логгеру приложения.

4. **Определите маршрут и функцию обработки**:

   ```python
   @app.route('/')
   def home():
       app.logger.info('Главная страница была запрошена')
       return 'Привет, мир!'
   ```

   Эта функция обрабатывает запросы к корневому URL и записывает информационное сообщение в лог при каждом обращении.

5. **Запустите приложение**:

   ```python
   if __name__ == '__main__':
       app.run()
   ```

## Управление зависимостями с помощью `requirements.txt`

Файл `requirements.txt` содержит список всех зависимостей вашего проекта, что упрощает их установку и управление.
Чтобы создать этот файл:

1. **Установите необходимые пакеты**:

   ```bash
   pip install Flask==2.0.1 requests==2.26.0 numpy==1.21.2
   ```

2. **Сохраните список установленных пакетов в `requirements.txt`**:

   ```bash
   pip freeze > requirements.txt
   ```

   Это создаст файл `requirements.txt` со следующим содержимым:

   ```
   Flask==2.0.1
   requests==2.26.0
   numpy==1.21.2
   ```

3. **Установка зависимостей из `requirements.txt`**:

   Чтобы установить все зависимости, перечисленные в `requirements.txt`, выполните:

   ```bash
   pip install -r requirements.txt
   ```

   Это обеспечит установку всех необходимых пакетов с указанными версиями, гарантируя совместимость и стабильность вашего приложения.

## Заключение

Настройка логирования с ротацией файлов в Flask и использование файла `requirements.txt` для управления зависимостями являются важными аспектами разработки стабильных и поддерживаемых приложений. Следуя этому руководству, вы сможете эффективно управлять логами и зависимостями в вашем проекте.
